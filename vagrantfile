Vagrant.configure("2") do |config|
  config.vm.box = "ubuntu/focal64" #Ubuntu 20.04
  config.vm.provider :virtualbox do |v|
  config.vm.network "forwarded_port", guest: 8081, host: 8081 #map host port 8081 to vm port 8081
  v.gui = true
  v.memory = 10192 #VM 8RAM
  v.cpus = "4" #VM CORES
  v.customize ["modifyvm", :id, "--vram", "256"] #VM Video memory in MB
  v.customize ["modifyvm", :id, "--clipboard", "bidirectional"] #Enable shared clipboard / require guest additions to be installed
  v.customize ["modifyvm", :id, "--uartmode1", "file", File.join(Dir.pwd, "serial.log") ] # Fix boot time issue and enable console log
  v.customize ["modifyvm", :id, "--hwvirtex", "on"]
  v.name = "SantosVM" #VM name in VirtualBox

  end

  config.vm.synced_folder ".", "/vagrant", type: "virtualbox"

  $script = <<-SCRIPT

  sudo apt -y update &&  upgrade
  sudo apt install -y --no-install-recommends ubuntu-desktop
  sudo apt install -y wget sudo maven openjdk-8-jre
  sudo apt install -y libgtk-3-0 libcanberra-gtk-module
  sudo usermod -aG sudo vagrant
  wget -nv --show-progress --progress=bar:force:noscroll http://mule-studio.s3.amazonaws.com/7.5.1-U1/AnypointStudio-7.5.1-linux64.tar.gz -O /tmp/studio.tar.gz
  tar -zxf /tmp/studio.tar.gz -C /home/vagrant/Desktop
  sudo shutdown -r now

  SCRIPT

  config.vm.provision "shell", inline: $script

  end
 
